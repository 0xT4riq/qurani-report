<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- ุงุณู ุงูุชุทุจูู ูู iOS -->
  <meta name="apple-mobile-web-app-title" content="ูุฑุขูู ูุจุถ ุญูุงุชู" />
  <!-- ุชุดุบูู ูุชุทุจูู ูุณุชูู -->
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <!-- ููู ุงูุดุฑูุท ุงูุนููู -->
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <!-- ุฃููููุฉ ูุฎุตุตุฉ ูู iOS -->
  <link rel="apple-touch-icon" href="logo.png" />

  <title>ููุตุฉ-ูุฑุขูู ูุจุถ ุญูุงุชู</title>
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div id="notification-icon-container" style="position: fixed; top: 10px; left: 10px;">
  <button onclick="toggleNotificationList()" id="notification-btn">
    ๐ <span id="notification-count" style="color: red; font-weight: bold;"></span>
  </button>
  <div id="notification-list" style="display: none; background: white; border: 1px solid #ccc; padding: 10px; max-width: 300px;">
    <ul id="notifications-ul"></ul>
    <button onclick="clearNotifications()">ูุณุญ ุงููู</button>
  </div>
</div>


  <div class="container">
    <div style="text-align: center; margin: 1px 0;">
      <img src="logo.png" alt="ุดุนุงุฑ ููุตุฉ-ูุฑุขูู ูุจุถ ุญูุงุชู" width="200" height="200" />
    </div>
    <h2>ููุตุฉ - ูุฑุขูู ูุจุถ ุญูุงุชู</h2>

    <div id="login-box">
      <label for="login-name" >ุงูุงุณู ุงูุซูุงุซู:</label>
      <input type="text" id="login-name" autocomplete="off" oninput="showNameSuggestions()" onblur="hideNameSuggestionsDelayed()">
      <div id="custom-suggestions"class="suggestions-list">

      </div>
      <label for="login-password">ูููุฉ ุงููุฑูุฑ:</label>
      <input type="password" id="login-password">
      <button onclick="login()">ุฏุฎูู</button>
      <button onclick="showRegister()">ุฅูุดุงุก ุญุณุงุจ ุฌุฏูุฏ</button>
    </div>

    <div id="register-box" class="hidden">
        <h3>ุงูุดุงุก ุญุณุงุจ ุฌุฏูุฏ</h3>
        <label for="register-name">ุงูุงุณู ุงูุซูุงุซู:</label>
        <input type="text" id="register-name">
        <label for="register-password">ูููุฉ ุงููุฑูุฑ:</label>
        <input type="password" id="register-password">
        <label for="joinedSurah">ุนูุฏ ุฃู ุณูุฑุฉ ุงูุถููุชุ</label>
        <select id="joinedSurah" required>
          <option value="">ุงุฎุชุฑ ุณูุฑุฉ...</option>
        </select>
        <button onclick="registerUser()">ุชุณุฌูู</button>
        <button onclick="showLogin()">ุงูุนูุฏุฉ ูุชุณุฌูู ุงูุฏุฎูู</button>
    </div>

    <div id="report-box" class="hidden">
      <button onclick="logout()" class="logout-btn">ุชุณุฌูู ุงูุฎุฑูุฌ</button>

      <button onclick="subscribeToNotifications()" id="subscribeBtn" style="margin-top: 10px;">๐ ุงูุงุดุชุฑุงู ูู ุงูุชูุจููุงุช ุงูุฃุณุจูุนูุฉ</button>

      <div id="update-info-form"style="margin-top: 20px; padding: 10px;">
      <button onclick="showUpdateForm()">โ๏ธ ุชุญุฏูุซ ุงููุนูููุงุช</button>
      <div id="update-form" style="display: none; margin-top: 10px;">
        <label for="update-username">ุงุณู ุงููุณุชุฎุฏู:</label>
        <input type="text" id="update-username" />

        <label for="update-password">ูููุฉ ุงููุฑูุฑ:</label>
        <input type="password" id="update-password" />

        <button onclick="submitUpdate()">๐พ ุญูุธ ุงูุชุบููุฑุงุช</button>
      </div>
      <hr>
      </div>

      

      <h3>ุชูุฑูุฑ ุงูุฃุณุจูุน</h3>
 
      <div id="report-form"style="display: none;">
        <label for="surahSelect">ุงุฎุชุฑ ุงูุณูุฑุฉ:</label>
        <select id="surahSelect">
          <option value="">ุงุฎุชุฑ ุณูุฑุฉ...</option>
        </select>
        <label for="weekSelect">ุงุฎุชุฑ ุงูุฃุณุจูุน:</label>
        <select id="weekSelect">
          <option value="">ุงุฎุชุฑ ุฃุณุจูุน...</option>
        </select>
        <div class="checkbox-group" id="reportChecklistContainer"></div>
        <button onclick="submitReport()">ุฅุฑุณุงู ุงูุชูุฑูุฑ</button>
      </div>
      <hr>
      <h4>ุชูุงุฑูุฑู ุงูุณุงุจูุฉ:</h4>
      <div class="filter-print-section">
          <label for="myReportWeekFilter">ุจุญุซ ุญุณุจ ุงูุฃุณุจูุน:</label>
          <select id="myReportWeekFilter" onchange="displayMyReports()">
              <option value="">ุฌููุน ุงูุฃุณุงุจูุน</option>
          </select>
          <label for="myReportSurahFilter">ุจุญุซ ุญุณุจ ุงูุณูุฑุฉ:</label>
          <select id="myReportSurahFilter" onchange="displayMyReports()">
              <option value="">ุฌููุน ุงูุณูุฑ</option>
          </select>
          <button id="exportBtn" onclick="exportFilteredPDF('student')">๐ ุชุญููู ุงูุชูุงุฑูุฑ ุญุณุจ ุงูุจุญุซ PDF</button>
      </div>
      <div id="my-reports-list"></div>
    </div>

    <div id="admin-box" class="hidden">
      <button onclick="logout()" class="logout-btn">ุชุณุฌูู ุงูุฎุฑูุฌ</button>
      
      <button onclick="openPasswordPopup()">ุนุฑุถ ูููุฉ ูุฑูุฑ ุทุงูุจ</button>
      <button onclick="showUserList()">ุฅุฏุงุฑุฉ ุญุณุงุจุงุช ุงูุทูุจุฉ</button>
      <div id="userListPopup" style="display: none; position: fixed; top: 20%; left: 50%; transform: translateX(-50%); background: white; border: 1px solid #ccc; padding: 20px; z-index: 1000; max-width: 500px; direction: rtl;">
        <h3>ูุงุฆูุฉ ุงูุญุณุงุจุงุช</h3>
        <div id="userList" style="max-height: 300px; overflow-y: auto;"></div>
        <button onclick="closeUserList()">ุฅุบูุงู</button>
      </div>


      <div id="passwordPopup" style="display: none; position: fixed; top: 20%; left: 50%; transform: translateX(-50%); background: white; border: 1px solid #ccc; padding: 20px; z-index: 1000; max-width: 400px; direction: rtl;">
        <h3>ุจุญุซ ุนู ูููุฉ ุงููุฑูุฑ</h3>
        <input type="text" id="studentSearch" placeholder="ุงูุชุจ ุงุณู ุงูุทุงูุจ" style="width: 100%; padding: 5px;" oninput="debouncedSearch()">
        
        <div id="passwordResults" style="margin-top: 10px; font-weight: bold; max-height: 200px; overflow-y: auto;"></div>
        
        <button onclick="closePasswordPopup()">ุฅุบูุงู</button>
      </div>

      <button onclick="openGlobalDataEditor()">ุชุนุฏูู ุจูุงูุงุช ุงููุธุงู</button>

      <div id="globalDataPopup">
        <h3>ุชุนุฏูู ุจูุงูุงุช ุงููุธุงู</h3>

        <label>ุนุฏุฏ ุงูุฃุณุงุจูุน:</label>
        <input type="number" id="adminWeeksInput" min="1" style="width: 80px;" />

        <label>ุงูุณูุฑ (ูู ุณูุฑุฉ ูู ุณุทุฑ ุฌุฏูุฏ):</label><br/>
        <textarea id="adminSurahsInput" rows="10" style="width: 100%;"></textarea>

        <label>ูุงุฆูุฉ ุงูููุงู:</label>
        <div id="adminChecklistContainer"></div>
        <button onclick="addChecklistItem()">+ ุฅุถุงูุฉ ุจูุฏ ุฌุฏูุฏ</button>

        <br/><br/>
        <button onclick="saveGlobalData()">ุญูุธ ุงูุชุบููุฑุงุช</button>
        <button onclick="closeGlobalDataEditor()" style="margin-left: 10px;">ุฅุบูุงู</button>
      </div>
      <h3>ููุญุฉ ุชุญูู ุงููุดุฑู</h3>
      <h4>ุทูุจุงุช ุชุณุฌูู ุงูุญุณุงุจ:</h4>
      <div id="accounts-requests"></div>
      <hr>
      <h4>ุงูุชูุงุฑูุฑ ุงููุฑุณูุฉ:</h4>
      <div class="search-box">
        <label for="searchInput">๐ ุงูุจุญุซ ุนู ุงุณู:</label>
        <input type="text" id="searchInput" placeholder="ุฃุฏุฎู ุงูุงุณู..." oninput="displayReports()">
      </div>
      <div class="filter-print-section">
          <label for="adminReportWeekFilter">ุจุญุซ ุญุณุจ ุงูุฃุณุจูุน:</label>
          <select id="adminReportWeekFilter" onchange="displayReports()">
              <option value="">ุฌููุน ุงูุฃุณุงุจูุน</option>
          </select>
          <label for="adminReportSurahFilter">ุจุญุซ ุญุณุจ ุงูุณูุฑุฉ:</label>
          <select id="adminReportSurahFilter" onchange="displayReports()">
              <option value="">ุฌููุน ุงูุณูุฑ</option>
          </select>

          <button id="exportFilteredReportsBtn" onclick="exportFilteredPDF('admin')">๐ ุชุญููู ุงูุชูุงุฑูุฑ ุญุณุจ ุงูุจุญุซ PDF</button>
          <button id="exportActivitySummaryBtn" onclick="generateActivitySummary()">๐ ุชุญููู ุงูุชูุฑูุฑ ุงููุฎุชุตุฑ PDF</button>

      </div>
      <button onclick="showReportSubmitters()">๐ ุนุฑุถ ูู ูุฏููุง ุชูุฑูุฑ</button>
      <div id="reports-list"></div>
    </div>
  </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>

  <script src="script.js"></script>
</body>
</html>